{{!
    This file is part of Moodle - http://moodle.org/

    Moodle is free software: you can redistribute it and/or modify
    it under the terms of the GNU General Public License as published by
    the Free Software Foundation, either version 3 of the License, or
    (at your option) any later version.

    Moodle is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU General Public License for more details.

    You should have received a copy of the GNU General Public License
    along with Moodle.  If not, see <http://www.gnu.org/licenses/>.
}}
{{!
    @template local_classreport/main

    This template renders the main content area for the class report local plugin.

    Example context (json):
    {}
}}
<div class="local_classreport_table_wrapper">
<div class="local_classreport_scroll_wrapper">
<table class="local_classreport_table">
    <thead>
        <tr>
            <th class="sticky-column"><span/></th>
            {{#courseheaders}}
            <th colspan="{{colspan}}" class="sticky-row-0 course-{{id}} category-{{category}}"><a href="/course/view.php?id={{id}}">{{name}}</a><br><span class="small">{{#userdate}} {{startdate}}, {{#str}} strftimedate {{/str}} {{/userdate}}</span></th>
            {{/courseheaders}}
        </tr>
        <tr>
            <th class="sticky-column">{{#str}} students {{/str}}</th>
            {{#activities}}
            <th class="sticky-row-1 category-{{category}} mod-{{name}}"><a href="/mod/{{name}}/view.php?id={{cmid}}">{{name}}</a></th>
            {{/activities}}
        </tr>
    </thead>
    <tbody>
    {{#table}}
        <tr>
            <th class="sticky-column {{class}}">{{{content}}}</th>
    {{#header}}
            <td colspan="{{colspan}}" class="{{class}}"></td>
    {{/header}}
    {{^header}}
            {{#columns}}<td class="state-{{complete}} category-{{category}}">{{#complete}}{{# pix }} i/valid, core{{/pix}}{{/complete}}{{^complete}}{{# pix }} i/invalid, core{{/pix}}{{/complete}}</td>{{/columns}}
    {{/header}}
        </tr>
    {{/table}}
</table>
</div>
</div>
{{#js}}
require(['jquery'], function($) {

    // resize table wrapper to fit viewport height
    function fitViewport() {
        var w = $(".local_classreport_table_wrapper"),
            pos = w.offset(),
            wh = $(window).height(),
            rem1 = parseInt($('html').css('font-size'));
        $(".local_classreport_scroll_wrapper").height(wh - pos.top - rem1);
    }

    $(window).on('resize', fitViewport);

    fitViewport();

});
{{/js}}